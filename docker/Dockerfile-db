FROM mysql:5.7.37
MAINTAINER wangjueming <king607267@gmail.com>
EXPOSE 3306

#default master
ARG CMANGOS_DATABASE_BRANCH=master
#default master
ARG CMANGOS_SERVER_BRANCH=master
#default classic
ARG CMANGOS_CORE=classic

ENV CMANGOS_CORE=${CMANGOS_CORE}

ENV TZ Asia/Shanghai

ENV REALM_IP=127.0.0.1
ENV REALM_PORT=8085
ENV REALM_NAME=MaNGOS

COPY launch_mysql.sh ./
COPY mangos-${CMANGOS_CORE}/sql ./mangos-${CMANGOS_CORE}/sql
COPY ${CMANGOS_CORE}-db/ACID ./${CMANGOS_CORE}-db/ACID
COPY ${CMANGOS_CORE}-db/Full_DB ./${CMANGOS_CORE}-db/Full_DB
COPY ${CMANGOS_CORE}-db/Updates ./${CMANGOS_CORE}-db/Updates
COPY ${CMANGOS_CORE}-db/utilities ./${CMANGOS_CORE}-db/utilities
COPY ${CMANGOS_CORE}-db/InstallFullDB.sh ./${CMANGOS_CORE}-db/InstallFullDB.sh

RUN chmod -R a+x,a+w,a+r ./${CMANGOS_CORE}-db && chmod a+x launch_mysql.sh

ENTRYPOINT ["./launch_mysql.sh"]
CMD ["mysqld"]
